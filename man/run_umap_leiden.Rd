% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/clustering.R
\name{run_umap_leiden}
\alias{run_umap_leiden}
\title{Run UMAP + Leiden Clustering via Python subprocess}
\usage{
run_umap_leiden(
  data_path,
  n_neighbors = 15,
  min_dist = 0.1,
  resolution = 0.42,
  n_bootstrap = 100,
  subsample_prop = 0.8,
  scan_resolutions = TRUE,
  stability_analysis = TRUE
)
}
\arguments{
\item{data_path}{Character. Path to input file (Excel or CSV). Last column should be condition labels.}

\item{n_neighbors}{Integer. UMAP n_neighbors parameter. Default 15.}

\item{min_dist}{Numeric. UMAP min_dist parameter. Default 0.1.}

\item{resolution}{Numeric. Leiden resolution parameter. Default 0.42.}

\item{n_bootstrap}{Integer. Number of bootstrap runs for stability. Default 100.}

\item{subsample_prop}{Numeric. Proportion of samples in each bootstrap. Default 0.8.}

\item{scan_resolutions}{Logical. If TRUE, scan resolution parameters. Default TRUE.}

\item{stability_analysis}{Logical. If TRUE, perform stability analysis. Default TRUE.}

\item{feature_threshold}{Numeric. Correlation threshold for feature filtering. Default 0.7.}
}
\value{
List with dataframes:
  \describe{
    \item{umap_df}{UMAP coordinates with cluster labels and conditions}
    \item{resolution_scan}{Resolution vs number of clusters (if scan_resolutions=TRUE)}
    \item{stability}{Bootstrap stability results (if stability_analysis=TRUE)}
    \item{correlation_before}{Correlation matrix before filtering}
    \item{correlation_after}{Correlation matrix after filtering}
  }
}
\description{
Performs feature selection, UMAP embedding, Leiden clustering, and stability analysis
by calling Python as a subprocess using processx.
}
