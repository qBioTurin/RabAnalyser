% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/clustering_analysis.R
\name{cluster_feature_stats}
\alias{cluster_feature_stats}
\title{Cluster-wise feature statistics using Mann-Whitney tests}
\usage{
cluster_feature_stats(reduced_df)
}
\arguments{
\item{reduced_df}{A \code{data.frame} containing numeric features and
cluster assignments. By default, the function assumes that the last two
columns are \code{Clusters} and \code{Conditions}, and all preceding
columns are numeric features.}
}
\value{
Invisibly returns a \code{data.frame} containing all statistical
  results (one row per feature and pair of clusters). The Excel file is
  written to disk and the dot plots are printed to the active graphics device.
}
\description{
This function performs statistical comparisons of feature distributions
between clusters and summarizes the results in an Excel file and dot plots.
For each feature, pairwise Mann-Whitney (Wilcoxon rank-sum) tests are
computed between clusters.
}
\details{
When there are only two clusters, a single Mann-Whitney test is performed
per feature without multiple-testing correction. When there are more than
two clusters, all pairwise comparisons are performed and p-values are
adjusted using Bonferroni correction.

The function also generates a dot plot:
\itemize{
  \item Color encodes the fold change (difference of medians) between clusters.
  \item Point size encodes the statistical significance (-log10(p-value)).
}


The function internally:
\enumerate{
  \item Determines the number of clusters from the \code{Clusters} column
  \item Uses all columns except the last two in \code{reduced_df} as
        features.
  \item For 2 clusters: performs one Mann-Whitney test per feature and
        reports p-values and fold changes.
  \item For more than 2 clusters: performs all pairwise Mann-Whitney tests
        per feature, applies Bonferroni correction, and indicates which
        comparisons are significant.
  \item Produces a dot plot summarizing the results:
        \itemize{
          \item Two clusters: size = -log10(raw p-value), color = fold change.
          \item More than two clusters: size = -log10(corrected p-value),
                color = fold change.
        }
}
}
