% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/clustering_visualization.R
\name{ks_cluster_fingerprint_heatmap}
\alias{ks_cluster_fingerprint_heatmap}
\title{Cluster fingerprint heatmap with custom white-band colormap}
\usage{
ks_cluster_fingerprint_heatmap(
  reduced_df,
  values_interval = NULL,
  midpoint_val = NULL,
  low_color = c("#2166ac"),
  mid_color = c("white"),
  high_color = c("#1b7837"),
  n_colors = 512
)
}
\arguments{
\item{reduced_df}{A \code{data.frame} where:
\itemize{
  \item All columns except the last two are numeric features.
  \item One of the last two columns is a cluster identifier named
        \code{"Clusters"} (e.g., cluster labels or subpopulation IDs).
  \item The other last column may be a grouping variable (e.g.,
        \code{"conditions"}); it is ignored here but kept for consistency
        with the original Python code.
}}

\item{values_interval}{Numeric vector, lower and upper bounds of the color scale (default NULL).}

\item{midpoint_val}{Numeric, midpoint of the color scale (default NULL).}
}
\value{
A list with:
  \itemize{
    \item \code{fingerprint_df}: a \code{data.frame} of mean feature values
          per cluster (rows = clusters, columns = features).
    \item \code{plot}: the \code{ggplot2} object for the heatmap.
  }
  The function also prints the heatmap to the current graphics device.
}
\description{
This function computes a "fingerprint" matrix by averaging feature values
per cluster and visualizes it as a heatmap with a custom diverging colormap
that includes a white band around zero.
}
\details{
The intended use case is for Kolmogorov-Smirnov (KS) statistics or similar
effect-size measures, where:
\itemize{
  \item KS < 0.15: small effect
  \item KS 0.15â€“0.25: moderate effect
  \item KS > 0.3: strong effect
}
These thresholds are arbitrary and can be chosen by visual inspection of
the distribution shifts.


Internally, the function:
\enumerate{
  \item Extracts feature columns as all columns except the last two.
  \item Groups rows by \code{Clusters} and computes the mean of each feature.
  \item Builds a custom diverging palette with:
        \itemize{
          \item A gradient from \code{vmin} up to \code{white_min} using
                \code{left_colors}.
          \item A white band from \code{white_min} to \code{white_max}.
          \item A gradient from \code{white_max} to \code{vmax} using
                \code{right_colors}.
        }
  \item Plots a heatmap using \code{ggplot2::geom_tile} with cluster
        on the y-axis, feature on the x-axis, and color encoding the
        mean value.
}
}
