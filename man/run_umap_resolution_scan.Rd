% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/clustering.R
\name{run_umap_resolution_scan}
\alias{run_umap_resolution_scan}
\title{UMAP Embedding and Resolution Parameter Scan}
\usage{
run_umap_resolution_scan(
  data,
  n_neighbors = 15,
  min_dist = 0.1,
  gamma_min = 0.1,
  gamma_max = 1,
  n_gamma_steps = 100,
  save_graph = TRUE
)
}
\arguments{
\item{data}{Either a file path (character string) to an Excel/CSV file, or a
data.frame. The last column should contain condition/class labels. If a
data.frame is provided, it will be saved to a temporary CSV file automatically.}

\item{n_neighbors}{Integer. Number of neighboring points used in UMAP manifold
approximation. Larger values preserve more global structure; smaller values
preserve more local structure. Default: 15.}

\item{min_dist}{Numeric. Minimum distance between points in UMAP embedding space.
Controls how tightly points can be packed together. Smaller values create
tighter clusters. Range: 0 to 1. Default: 0.1.}

\item{gamma_min}{Numeric. Minimum resolution (gamma) value to test. Lower gamma
produces fewer, larger clusters. Default: 0.1.}

\item{gamma_max}{Numeric. Maximum resolution (gamma) value to test. Higher gamma
produces more, smaller clusters. Default: 1.0.}

\item{n_gamma_steps}{Integer. Number of gamma values to test between gamma_min
and gamma_max. More steps provide finer resolution in the scan. Default: 100.}

\item{save_graph}{Logical. If TRUE, saves the UMAP graph to disk for use in
subsequent clustering with \code{\link{run_leiden_clustering}}. Default: TRUE.}
}
\value{
A list containing:
  \describe{
    \item{umap_df}{Data.frame with UMAP coordinates (UMAP1, UMAP2) and original
      condition labels (Class) for each sample.}
    \item{resolution_scan}{Data.frame showing the relationship between gamma
      values and the resulting number of clusters. Use this to select optimal gamma.}
    \item{graph_path}{Character string with path to the saved UMAP graph file
      (.pkl format). Only included if save_graph=TRUE. Required for subsequent
      clustering with \code{\link{run_leiden_clustering}}.}
  }
}
\description{
Performs dimensionality reduction using UMAP (Uniform Manifold Approximation
and Projection) and systematically scans Leiden clustering resolution parameters
(gamma) to help identify the optimal resolution for achieving a desired number
of clusters. This is the first step in a two-stage clustering workflow.
}
\details{
The function creates a UMAP graph from the input data and tests multiple gamma
values to show how the number of clusters varies with resolution. This allows
users to make an informed decision about which gamma value to use for final
clustering.


This function calls a Python script that uses umap-learn and igraph libraries.
The UMAP graph is constructed using the specified n_neighbors and min_dist
parameters, then Leiden clustering is run with various gamma values to create
the resolution scan.

After running this function, examine the resolution_scan data frame or plot it
using \code{\link{plot_resolution_scan}} to choose an appropriate gamma value
for final clustering.
}
\examples{
\dontrun{
# Using a file path
results <- run_umap_resolution_scan(
  data = "path/to/features.csv",
  n_neighbors = 15,
  gamma_min = 0.1,
  gamma_max = 2.0,
  n_gamma_steps = 100
)

# View resolution scan results
print(results$resolution_scan)
plot_resolution_scan(results$resolution_scan)

# Using a data.frame directly
results <- run_umap_resolution_scan(data = my_features_df)

# Proceed to clustering with selected gamma
clusters <- run_leiden_clustering(
  umap_data = results$umap_df,
  graph_path = results$graph_path,
  gamma = 0.42
)
}
}
\seealso{
\code{\link{run_leiden_clustering}} for the second step of clustering,
  \code{\link{plot_resolution_scan}} for visualizing the scan results,
  \code{\link{plot_umap}} for visualizing UMAP embeddings
}
